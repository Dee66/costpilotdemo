# CostPilot Demo Snapshots

**Scenario Version:** `v1`

This directory contains canonical, deterministic snapshots of CostPilot outputs for the demonstration repository. These snapshots serve as the ground truth for:

- Marketing materials and screenshots
- Product documentation examples
- Launch video assets
- PR walkthrough demonstrations
- CI/CD verification tests

## ğŸ“¸ Snapshot Inventory

### Terraform Plans
- `plan_before.json` - Terraform plan from baseline (main branch)
- `plan_after.json` - Terraform plan from PR branch with regressions
- `plan_diff.json` - Computed diff between before/after plans

### CostPilot Outputs (Trust Triangle)
- `detect_v1.json` - **Detect** phase: Resource classification, rule violations, severity scoring
- `predict_v1.json` - **Predict** phase: Cost impact ranges with heuristic references
- `explain_v1.json` - **Explain** phase: Root cause analysis, regression types, delta justification

### Patch Preview (Autofix)
- `snippet_v1.tf` - Terraform code snippet for EC2 and S3 fixes
- `patch_v1.diff` - Unified diff patch for automated remediation

## ğŸ”’ Deterministic Constraints

All snapshots in this directory are **hash-stable** and **drift-protected**:

- Float precision fixed to 2 decimal places
- Whitespace normalization enforced
- Ordering rules applied consistently
- Mapping layout seed fixed
- Trend theme fixed

## ğŸ›¡ï¸ CI Protection

These files are **protected by CI guardrails**:
- âŒ Direct modifications blocked
- âœ… Changes only via `tools/reset_demo.sh`
- âœ… Hash validation on every PR
- âœ… Drift detection enabled

## ğŸ”„ Regeneration

To regenerate all snapshots deterministically:

```bash
./tools/reset_demo.sh
```

This script:
1. Restores baseline infrastructure
2. Regenerates Terraform plans
3. Runs CostPilot detect/predict/explain
4. Validates deterministic hashes
5. Fails on any drift detected

## ğŸ“Š Snapshot Hashes

Canonical checksums are stored in `snapshot_hashes.txt` (generated by reset script). Any deviation from these hashes indicates drift and will fail CI.

## ğŸ¯ Trust Triangle Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Trust Triangle                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  1ï¸âƒ£  DETECT (detect_v1.json)                           â”‚
â”‚      â”œâ”€ Classify resources                              â”‚
â”‚      â”œâ”€ Apply cost regression rules                     â”‚
â”‚      â””â”€ Score severity                                  â”‚
â”‚                                                          â”‚
â”‚  2ï¸âƒ£  PREDICT (predict_v1.json)                         â”‚
â”‚      â”œâ”€ Reference heuristics                            â”‚
â”‚      â”œâ”€ Calculate cost ranges [low, high]               â”‚
â”‚      â””â”€ Document cold-start assumptions                 â”‚
â”‚                                                          â”‚
â”‚  3ï¸âƒ£  EXPLAIN (explain_v1.json)                         â”‚
â”‚      â”œâ”€ Identify root cause                             â”‚
â”‚      â”œâ”€ Classify regression type                        â”‚
â”‚      â”œâ”€ Trace heuristic provenance                      â”‚
â”‚      â””â”€ Justify delta with reasoning                    â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ Artifact Distribution

Snapshots are copied to multiple locations for different use cases:

- `.costpilot/demo/` - Internal demo artifacts
- `costpilot_artifacts/` - CI/CD pipeline outputs
- `snapshots/` - Canonical source of truth (this directory)

## âš ï¸ Important Notes

- **Never edit snapshots manually** - always use `reset_demo.sh`
- **Version suffix (`_v1`)** indicates scenario version from `products.yml`
- **Patch preview scope limited** to EC2 and S3 only (networking excluded)
- **All outputs are public-safe** - no sensitive data included

## ğŸ“š Related Documentation

- [Main README](../README.md) - Complete demo walkthrough
- [PR #42 Walkthrough](../docs/walkthrough.md) - Step-by-step PR analysis
- [products.yml](../docs/products.yml) - Full specification
- [checklist.yml](../docs/checklist.yml) - Implementation checklist

---

**Last Updated:** Generated deterministically by `reset_demo.sh`  
**Scenario Version:** v1  
**Spec Version:** 1.0.0
