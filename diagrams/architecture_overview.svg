<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 700">
  <!-- Title -->
  <text x="500" y="35" text-anchor="middle" font-size="22" font-weight="bold" fill="#1F2937">
    CostPilot Demo Architecture
  </text>
  <text x="500" y="60" text-anchor="middle" font-size="13" fill="#6B7280">
    Baseline Stack (Cost-Efficient) → PR Change Stack (With Regressions)
  </text>

  <!-- ALB -->
  <g id="alb">
    <rect x="400" y="100" width="200" height="60" rx="8" fill="#3B82F6" opacity="0.2" stroke="#3B82F6" stroke-width="2"/>
    <text x="500" y="125" text-anchor="middle" font-size="14" font-weight="bold" fill="#1E40AF">
      Application Load Balancer
    </text>
    <text x="500" y="145" text-anchor="middle" font-size="11" fill="#1E40AF">
      aws_lb.main
    </text>
  </g>

  <!-- Arrow ALB to TG -->
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#6B7280" />
    </marker>
    <marker id="arrow-red" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#DC2626" />
    </marker>
  </defs>
  <line x1="500" y1="160" x2="500" y2="200" stroke="#6B7280" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Target Group -->
  <g id="target-group">
    <rect x="400" y="200" width="200" height="60" rx="8" fill="#3B82F6" opacity="0.2" stroke="#3B82F6" stroke-width="2"/>
    <text x="500" y="225" text-anchor="middle" font-size="14" font-weight="bold" fill="#1E40AF">
      Target Group
    </text>
    <text x="500" y="245" text-anchor="middle" font-size="11" fill="#1E40AF">
      aws_lb_target_group.main
    </text>
  </g>

  <!-- Arrow TG to ASG -->
  <line x1="500" y1="260" x2="500" y2="300" stroke="#6B7280" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Auto Scaling Group -->
  <g id="asg">
    <rect x="350" y="300" width="300" height="80" rx="8" fill="#FBBF24" opacity="0.2" stroke="#FBBF24" stroke-width="2"/>
    <text x="500" y="325" text-anchor="middle" font-size="14" font-weight="bold" fill="#D97706">
      Auto Scaling Group
    </text>
    <text x="500" y="345" text-anchor="middle" font-size="11" fill="#D97706">
      aws_autoscaling_group.main
    </text>
    <text x="500" y="365" text-anchor="middle" font-size="11" fill="#D97706">
      min: 2 | max: 4 | desired: 2
    </text>
  </g>

  <!-- Arrow ASG to EC2 -->
  <line x1="450" y1="380" x2="300" y2="430" stroke="#6B7280" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="550" y1="380" x2="700" y2="430" stroke="#6B7280" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- EC2 Instance 1 (Baseline) -->
  <g id="ec2-baseline">
    <rect x="200" y="430" width="200" height="100" rx="8" fill="#10B981" opacity="0.2" stroke="#10B981" stroke-width="2"/>
    <text x="300" y="455" text-anchor="middle" font-size="14" font-weight="bold" fill="#059669">
      EC2 Instance (Baseline)
    </text>
    <text x="300" y="475" text-anchor="middle" font-size="12" fill="#059669">
      t3.micro ✅
    </text>
    <text x="300" y="495" text-anchor="middle" font-size="11" fill="#059669">
      2 vCPU, 1GB RAM
    </text>
    <text x="300" y="515" text-anchor="middle" font-size="11" fill="#059669">
      $0.0104/hr
    </text>
  </g>

  <!-- EC2 Instance 2 (PR Change) -->
  <g id="ec2-pr-change">
    <rect x="600" y="430" width="200" height="100" rx="8" fill="#DC2626" opacity="0.2" stroke="#DC2626" stroke-width="2"/>
    <text x="700" y="455" text-anchor="middle" font-size="14" font-weight="bold" fill="#DC2626">
      EC2 Instance (PR Change)
    </text>
    <text x="700" y="475" text-anchor="middle" font-size="12" fill="#DC2626">
      t3.xlarge ❌
    </text>
    <text x="700" y="495" text-anchor="middle" font-size="11" fill="#DC2626">
      4 vCPU, 16GB RAM
    </text>
    <text x="700" y="515" text-anchor="middle" font-size="11" fill="#DC2626">
      $0.1664/hr (16x cost!)
    </text>
  </g>

  <!-- EBS Volumes -->
  <g id="ebs-baseline">
    <rect x="50" y="550" width="120" height="50" rx="5" fill="#6B7280" opacity="0.2" stroke="#6B7280" stroke-width="1.5"/>
    <text x="110" y="570" text-anchor="middle" font-size="11" font-weight="bold" fill="#374151">
      EBS: 20GB ✅
    </text>
    <text x="110" y="590" text-anchor="middle" font-size="10" fill="#374151">
      $2/mo
    </text>
  </g>
  <line x1="250" y1="530" x2="110" y2="550" stroke="#6B7280" stroke-width="1.5" stroke-dasharray="5,5" marker-end="url(#arrow)"/>

  <g id="ebs-pr-change">
    <rect x="830" y="550" width="120" height="50" rx="5" fill="#DC2626" opacity="0.2" stroke="#DC2626" stroke-width="1.5"/>
    <text x="890" y="570" text-anchor="middle" font-size="11" font-weight="bold" fill="#DC2626">
      EBS: 200GB ❌
    </text>
    <text x="890" y="590" text-anchor="middle" font-size="10" fill="#DC2626">
      $20/mo (10x!)
    </text>
  </g>
  <line x1="750" y1="530" x2="890" y2="550" stroke="#DC2626" stroke-width="1.5" stroke-dasharray="5,5" marker-end="url(#arrow-red)"/>

  <!-- CloudWatch Logs -->
  <g id="cloudwatch">
    <rect x="200" y="620" width="150" height="60" rx="6" fill="#FBBF24" opacity="0.2" stroke="#FBBF24" stroke-width="1.5"/>
    <text x="275" y="640" text-anchor="middle" font-size="11" font-weight="bold" fill="#D97706">
      CloudWatch Logs
    </text>
    <text x="275" y="660" text-anchor="middle" font-size="10" fill="#D97706">
      Baseline: 30d ✅
    </text>
  </g>
  <line x1="300" y1="530" x2="275" y2="620" stroke="#FBBF24" stroke-width="1.5" stroke-dasharray="3,3"/>

  <g id="cloudwatch-pr">
    <rect x="650" y="620" width="150" height="60" rx="6" fill="#DC2626" opacity="0.2" stroke="#DC2626" stroke-width="1.5"/>
    <text x="725" y="640" text-anchor="middle" font-size="11" font-weight="bold" fill="#DC2626">
      CloudWatch Logs
    </text>
    <text x="725" y="660" text-anchor="middle" font-size="10" fill="#DC2626">
      PR: Infinite ❌
    </text>
  </g>
  <line x1="700" y1="530" x2="725" y2="620" stroke="#DC2626" stroke-width="1.5" stroke-dasharray="3,3" marker-end="url(#arrow-red)"/>

  <!-- S3 Bucket -->
  <g id="s3">
    <rect x="25" y="90" width="200" height="80" rx="8" fill="#10B981" opacity="0.2" stroke="#10B981" stroke-width="2"/>
    <text x="125" y="115" text-anchor="middle" font-size="13" font-weight="bold" fill="#059669">
      S3 Bucket (Baseline)
    </text>
    <text x="125" y="135" text-anchor="middle" font-size="11" fill="#059669">
      Lifecycle: 90d ✅
    </text>
    <text x="125" y="155" text-anchor="middle" font-size="10" fill="#059669">
      Auto-expires old objects
    </text>
  </g>

  <g id="s3-pr">
    <rect x="775" y="90" width="200" height="80" rx="8" fill="#DC2626" opacity="0.2" stroke="#DC2626" stroke-width="2"/>
    <text x="875" y="115" text-anchor="middle" font-size="13" font-weight="bold" fill="#DC2626">
      S3 Bucket (PR Change)
    </text>
    <text x="875" y="135" text-anchor="middle" font-size="11" fill="#DC2626">
      Lifecycle: NONE ❌
    </text>
    <text x="875" y="155" text-anchor="middle" font-size="10" fill="#DC2626">
      Objects accumulate forever
    </text>
  </g>

  <!-- Legend -->
  <g id="legend">
    <rect x="820" y="620" width="15" height="15" fill="#10B981" opacity="0.3"/>
    <text x="840" y="632" font-size="11" fill="#1F2937">Baseline (Cost-Efficient)</text>

    <rect x="820" y="645" width="15" height="15" fill="#DC2626" opacity="0.3"/>
    <text x="840" y="657" font-size="11" fill="#1F2937">PR Change (Regression)</text>
  </g>

  <!-- Cost Summary -->
  <text x="500" y="695" text-anchor="middle" font-size="11" fill="#6B7280">
    Monthly Cost: Baseline $52.43 → PR Change $387.89 (+639.82%)
  </text>
</svg>
