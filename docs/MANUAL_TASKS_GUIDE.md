# Manual Tasks Execution Guide

**Purpose:** Step-by-step instructions for completing the remaining manual validation tasks in the CostPilot Demo repository.

**Status:** 26 tasks remaining (8% of total)
- 5 Screenshot captures
- 5 CostPilot CLI executions
- 2 AWS infrastructure tasks (optional)
- 1 Screenshot validation

---

## Prerequisites

### For Screenshot Capture (5 tasks)
- **Required:**
  - Display resolution: 1920x1080 or higher
  - VS Code with light theme enabled
  - Terminal with clear, readable font
  - Golden outputs in `snapshots/` directory

- **Tools:**
  - macOS: `Cmd+Shift+4` for area screenshot
  - Linux: `gnome-screenshot -a` or `spectacle` (KDE)
  - Windows: `Win+Shift+S` or Snipping Tool

### For CostPilot CLI Testing (5 tasks)
- **Required:**
  - CostPilot CLI installed (`pip install costpilot` or from source)
  - Python 3.9+
  - Terraform 1.6+

### For AWS Infrastructure (2 tasks - Optional)
- **Required:**
  - AWS credentials configured (`aws configure`)
  - Appropriate IAM permissions (EC2, S3, CloudWatch)
  - **Note:** These tasks are optional and can be deferred

---

## Task Category 1: Screenshot Capture (5 tasks)

### Overview
Capture high-quality screenshots demonstrating CostPilot output in the terminal. All screenshots must be:
- Resolution: 1920x1080
- Theme: Light/default terminal theme
- Format: PNG
- Location: `visual_assets/`
- Named exactly as specified

### Task 1.1: Capture detect_output_screenshot.png

**Source:** Display content from `snapshots/detect_v1.json`

**Steps:**
1. Open terminal at 1920x1080 resolution
2. Navigate to repository root
3. Run display command:
   ```bash
   cat snapshots/detect_v1.json | jq '.'
   ```
4. Ensure entire output is visible (adjust terminal size if needed)
5. Take screenshot of terminal window
6. Save as `visual_assets/detect_output_screenshot.png`

**Validation:**
- File size < 2MB
- Clear, readable JSON output
- Shows findings array with severity indicators
- Version tag visible in metadata

### Task 1.2: Capture explain_mode_screenshot.png

**Source:** Display content from `snapshots/explain_v1.json`

**Steps:**
1. In terminal, run:
   ```bash
   cat snapshots/explain_v1.json | jq '.'
   ```
2. Capture terminal showing explanations array
3. Save as `visual_assets/explain_mode_screenshot.png`

**Validation:**
- Shows root_cause fields
- Shows heuristic_provenance
- Clear severity scores visible

### Task 1.3: Capture mapping_graph.png

**Source:** Render `snapshots/mapping_v1.mmd` as diagram

**Steps:**
1. Option A: Use Mermaid Live Editor
   - Go to https://mermaid.live
   - Paste content from `snapshots/mapping_v1.mmd`
   - Take screenshot of rendered diagram
   
2. Option B: Use VS Code extension
   - Install Mermaid Preview extension
   - Open `snapshots/mapping_v1.mmd`
   - Use preview pane to render
   - Take screenshot

3. Save as `visual_assets/mapping_graph.png`

**Validation:**
- Shows ALB → TG → ASG → EC2 flow
- Color-coded nodes visible (red for high cost, yellow for medium)
- All edges/arrows clear

### Task 1.4: Capture trend_graph.png

**Source:** Would normally be generated by CostPilot, but can mock

**Steps:**
1. For demo purposes, create simple trend visualization:
   ```bash
   # Use terminal-based chart or spreadsheet
   # Show cost progression over time
   # Include baseline, current, and projected costs
   ```
2. Save as `visual_assets/trend_graph.png`

**Alternative:** Use `trend_history_v1.json` data to create chart in Excel/Google Sheets

### Task 1.5: Capture pr_comment_cost_diff.png

**Source:** Display one of the PR comment templates

**Steps:**
1. Open `pr_comment_assets/comment_predict.txt` in GitHub-style markdown viewer
2. Or render in VS Code markdown preview
3. Capture the formatted output showing cost difference table
4. Save as `visual_assets/pr_comment_cost_diff.png`

**Validation:**
- Shows baseline → PR cost change
- Dollar amounts clearly visible
- Percentage increase highlighted

---

## Task Category 2: CostPilot CLI Testing (5 tasks)

### Overview
Execute CostPilot detect mode on noise test cases to verify zero findings (false-positive resilience).

### Prerequisites Check
```bash
# Verify CostPilot CLI is installed
costpilot --version

# Verify Terraform is available
terraform --version

# Navigate to repository root
cd /home/dee/workspace/AI/CostPilotDemo
```

### Task 2.1: Test whitespace_only.tf

**Expected:** Zero findings (whitespace changes should not trigger cost alerts)

**Steps:**
```bash
# Navigate to test case
cd infrastructure/terraform/noise-cases

# Run CostPilot detect
costpilot detect \
  --baseline ../baseline/main.tf \
  --change whitespace_only.tf \
  --output whitespace_test_output.json

# Verify zero findings
cat whitespace_test_output.json | jq '.findings | length'
# Expected output: 0
```

**Success Criteria:**
- Exit code 0
- `findings` array is empty
- No cost impact detected

### Task 2.2: Test comments_only.tf

**Steps:**
```bash
costpilot detect \
  --baseline ../baseline/main.tf \
  --change comments_only.tf \
  --output comments_test_output.json

cat comments_test_output.json | jq '.findings | length'
# Expected: 0
```

### Task 2.3: Test reordered_resources.tf

**Steps:**
```bash
costpilot detect \
  --baseline ../baseline/main.tf \
  --change reordered_resources.tf \
  --output reordered_test_output.json

cat reordered_test_output.json | jq '.findings | length'
# Expected: 0
```

### Task 2.4: Test description_change.tf

**Steps:**
```bash
costpilot detect \
  --baseline ../baseline/main.tf \
  --change description_change.tf \
  --output description_test_output.json

cat description_test_output.json | jq '.findings | length'
# Expected: 0
```

### Task 2.5: Verify All Noise Cases

**Aggregate validation:**
```bash
# Run all tests and collect results
for test in whitespace_only comments_only reordered_resources description_change; do
  echo "Testing ${test}.tf..."
  costpilot detect \
    --baseline ../baseline/main.tf \
    --change ${test}.tf \
    --output ${test}_output.json
  
  findings=$(cat ${test}_output.json | jq '.findings | length')
  
  if [ "$findings" -eq 0 ]; then
    echo "  ✅ PASS: Zero findings"
  else
    echo "  ❌ FAIL: $findings findings (expected 0)"
  fi
done
```

**Success Criteria:**
- All 4 tests pass with zero findings
- Demonstrates false-positive resilience
- Update CI to include these results

---

## Task Category 3: AWS Infrastructure (2 tasks - OPTIONAL)

### ⚠️ Important Notice
These tasks are **OPTIONAL** and **DEFERRED** for the following reasons:
1. Repository is fully functional without AWS resources
2. Zero-cost guarantee is a core requirement
3. Terraform plans can be generated without actual deployment
4. Golden outputs already exist and are validated

### Task 3.1: Regenerate plan_after.json (DEFERRED)

**If you choose to execute (not recommended):**

**Prerequisites:**
- AWS credentials configured
- Understand this will incur costs
- Have budget alerts set up

**Steps:**
```bash
cd infrastructure/terraform/pr-change

# Initialize
terraform init

# Generate plan (DO NOT APPLY)
terraform plan -out=plan_after.tfplan

# Convert to JSON
terraform show -json plan_after.tfplan > ../../../snapshots/plan_after.json

# IMPORTANT: Destroy any resources if accidentally created
terraform destroy -auto-approve
```

**Why Deferred:**
- Current `plan_after.json` is sufficient for demo
- No AWS resources should be deployed (zero-cost requirement)
- Plan can be regenerated from existing Terraform configs

### Task 3.2: Update plan_diff.json (DEFERRED)

**Depends on:** Task 3.1 completion

**Steps:**
```bash
# Generate diff between baseline and PR plans
python3 tools/generate_plan_diff.py \
  snapshots/plan_before.json \
  snapshots/plan_after.json \
  --output snapshots/plan_diff.json
```

**Why Deferred:**
- Depends on plan_after.json regeneration
- Current diff is sufficient for demonstration
- No functional impact on repository

---

## Task Category 4: Screenshot Validation (1 task)

### Task 4.1: Verify Screenshots Match Golden Outputs

**Prerequisites:** All 5 screenshots captured

**Steps:**

1. **Visual Inspection:**
   ```bash
   # Open screenshots
   open visual_assets/detect_output_screenshot.png
   open visual_assets/explain_mode_screenshot.png
   open visual_assets/mapping_graph.png
   open visual_assets/trend_graph.png
   open visual_assets/pr_comment_cost_diff.png
   ```

2. **Content Validation Checklist:**
   - [ ] detect screenshot matches `snapshots/detect_v1.json` content
   - [ ] explain screenshot matches `snapshots/explain_v1.json` content
   - [ ] mapping diagram reflects `snapshots/mapping_v1.mmd` structure
   - [ ] trend graph uses `snapshots/trend_history_v1.json` data
   - [ ] PR comment shows cost delta from `pr_comment_assets/comment_predict.txt`

3. **Quality Validation:**
   - [ ] All screenshots at 1920x1080 resolution
   - [ ] All screenshots < 2MB file size
   - [ ] All screenshots use light theme
   - [ ] All text is clear and readable
   - [ ] Version tags visible where applicable

4. **Documentation:**
   - Update `visual_assets/screenshots_manifest.json` status to "captured"
   - Add capture_date timestamp
   - Note any deviations from expected output

---

## Progress Tracking

### Update Checklist After Completion

After completing tasks, update `checklist.md`:

```bash
# For each completed task, change:
- [ ] Task description
# to:
- [x] Task description
```

### Run Validation

```bash
# Run comprehensive test suite
python3 scripts/test_comprehensive.py

# Run safeguard tests
bash scripts/test_safeguards.sh

# Verify no drift
git status
```

---

## Completion Criteria

### Repository is "Complete" When:
- ✅ All programmatic tasks done (COMPLETE)
- ✅ All documentation written (COMPLETE)
- ✅ All tests implemented (408 tests COMPLETE)
- ✅ All infrastructure code ready (COMPLETE)
- ⏳ Screenshots captured (5 pending)
- ⏳ CLI tests executed (5 pending)
- ✅ AWS tasks deferred (optional)

### Current State: **92% Complete (292/318 tasks)**

### With Manual Tasks: **100% Complete (318/318 tasks)**

---

## Troubleshooting

### Issue: CostPilot CLI not found
**Solution:** Install via `pip install costpilot` or follow installation guide

### Issue: Screenshots too large
**Solution:** Compress using `pngquant` or `optipng`
```bash
pngquant visual_assets/*.png --quality=80-90 --ext .png --force
```

### Issue: Mermaid diagram won't render
**Solution:** Validate syntax using Mermaid CLI or online validator
```bash
mmdc -i snapshots/mapping_v1.mmd -o visual_assets/mapping_graph.png
```

### Issue: AWS credentials error
**Solution:** Don't execute AWS tasks - they're optional and deferred

---

## Support

For questions or issues:
1. Check existing golden outputs in `snapshots/`
2. Review PR comment templates in `pr_comment_assets/`
3. Consult `visual_assets/README.md` for screenshot requirements
4. Run tests to verify current state: `python3 scripts/test_comprehensive.py`

---

**Last Updated:** 2025-12-06  
**Status:** Ready for manual execution  
**Estimated Time:** 1-2 hours for all manual tasks
